<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>PiecewiseLorentz · Piecewise</title><meta name="title" content="PiecewiseLorentz · Piecewise"/><meta property="og:title" content="PiecewiseLorentz · Piecewise"/><meta property="twitter:title" content="PiecewiseLorentz · Piecewise"/><meta name="description" content="Documentation for Piecewise."/><meta property="og:description" content="Documentation for Piecewise."/><meta property="twitter:description" content="Documentation for Piecewise."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="index.html"><img src="assets/logo.png" alt="Piecewise logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">Piecewise</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Piecewise</a></li><li><a class="tocitem" href="hilbert.html">PiecewiseHilbert</a></li><li class="is-active"><a class="tocitem" href="lorentz.html">PiecewiseLorentz</a><ul class="internal"><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#momentexpansion-L"><span>Moment expansion</span></a></li><li><a class="tocitem" href="#Primitives"><span>Primitives</span></a></li><li><a class="tocitem" href="#Public-interface"><span>Public interface</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="lorentz.html">PiecewiseLorentz</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="lorentz.html">PiecewiseLorentz</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ChristopheBerthod/Piecewise.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ChristopheBerthod/Piecewise.jl/blob/main/docs/src/lorentz.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="PiecewiseLorentz"><a class="docs-heading-anchor" href="#PiecewiseLorentz">PiecewiseLorentz</a><a id="PiecewiseLorentz-1"></a><a class="docs-heading-anchor-permalink" href="#PiecewiseLorentz" title="Permalink"></a></h1><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><p>The package won&#39;t work without <a href="https://github.com/ChristopheBerthod/Piecewise.jl">Piecewise</a>. Both can be installed with <code>Pkg.add</code>.</p><pre><code class="language-julia hljs">using Pkg; Pkg.add(&quot;Piecewise&quot;); Pkg.add(&quot;PiecewiseLorentz&quot;)</code></pre><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>The order-<span>$m$</span> Lorentz transform of a function <span>$f(x)$</span> of a real variable <span>$x$</span> is defined as</p><p class="math-container">\[\left(L^m\circ f\right)(y, z) = \int_{-\infty}^{\infty}dx\,f(x)
\left[\frac{-\mathrm{Im}\,z/\pi}{(y-\mathrm{Re}\,z-x)^2+(\mathrm{Im}\,z)^2}\right]^m,\]</p><p>where <span>$m$</span> is a positive integer, <span>$y$</span> is a real number, and <span>$z$</span> is a complex number with strictly negative imaginary part. The name <em>Lorentz transform</em> was chosen, because the function in square brackets is a <a href="https://en.wikipedia.org/wiki/Cauchy_distribution">Lorentzian</a> of half-width <span>$\mathrm{Im}\,z$</span> centered at <span>$x=y-\mathrm{Re}\,z$</span>.</p><p>The module <a href="https://github.com/ChristopheBerthod/Piecewise.jl">PiecewiseLorentz</a> adds to the <a href="index.html#Formulas">Formulas</a> defined in the module <a href="index.html#Piecewise">Piecewise</a> the primitive functions corresponding to the order-<span>$m$</span> Lorentz kernel <span>$\left[\frac{-\mathrm{Im}\,z/\pi}{(y-\mathrm{Re}\,z-x)^2+(\mathrm{Im}\,z)^2}\right]^m$</span>, enabling the fast Lorentz transform of <a href="index.html#PiecewiseFunction"><code>PiecewiseFunction</code></a> objects using these formulas.</p><div class="admonition is-warning" id="Warning-2f69dde58fdf4ddf"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-2f69dde58fdf4ddf" title="Permalink"></a></header><div class="admonition-body"><p>The present version only implements <span>$m=1,2,3$</span> for the formulas <a href="index.html#POLY"><code>POLY</code></a>, <a href="index.html#LOG"><code>LOG</code></a>, <a href="index.html#PLS"><code>PLS</code></a>, and <a href="index.html#XLOG"><code>XLOG</code></a>. Note that the <span>$m=1$</span> Lorentz transform is equivalent to a Hilbert transform:</p><p class="math-container">\[\left(L^1\circ f\right)(y, z) = -\frac{1}{\pi}\mathrm{Im}\,
\left(H\circ f\right)(y-z).\]</p></div></div><p>The method <a href="lorentz.html#PiecewiseLorentz.lorentz_transform"><code>lorentz_transform</code></a> return the Lorentz transform of a <a href="index.html#PiecewiseFunction"><code>PiecewiseFunction</code></a> object, as calculated using the definition above. The transform has algebraic tails at large <span>$y$</span>, that may suffer from numerical errors. A numerically more stable <a href="lorentz.html#momentexpansion-L">moment expansion</a> is therefore used for large values of <span>$|y-\mathrm{Re}\,z|$</span>. Both the definition and the moment expansion are implemented in a <a href="lorentz.html#PiecewiseLorentz.LorentzTransform"><code>LorentzTransform</code></a> object created as:</p><pre><code class="nohighlight hljs">L = LorentzTransform(f::PiecewiseFunction, m::Integer[, ground::Real])</code></pre><p>The moment expansion is used if <span>$y-\mathrm{Re}\,z$</span> is outside the <a href="index.html#Piecewise.support">support</a> of the piecewise function <code>f</code> and if the definition yields a result smaller than <code>ground</code> (by default <code>1e-10</code>). Once initialized, the Lorentz transform can be evaluated as <code>L(y, z)</code>.</p><h2 id="momentexpansion-L"><a class="docs-heading-anchor" href="#momentexpansion-L">Moment expansion</a><a id="momentexpansion-L-1"></a><a class="docs-heading-anchor-permalink" href="#momentexpansion-L" title="Permalink"></a></h2><p>The expansion of the order-<span>$m$</span> Lorentz transform for large <span>$|y-\mathrm{Re}\,z|$</span> is</p><p class="math-container">\[\begin{align*}
\left(L^m\circ f\right)(y, z)&amp;=\sum_{n=2m}^{\infty}
\frac{1}{(y-\mathrm{Re}\,z)^n}
\int_{-\infty}^{\infty}dx\,f(x)P_n^{(m)}(x,\mathrm{Im}\,z)\\
P_n^{(m)}(x,a)&amp;=\frac{1}{n!}\frac{d^n}{du^n}
\left[\frac{-a/\pi}{(1/u-x)^2+a^2}\right]^m_{u=0}\\
&amp;=\left(\frac{a}{2\pi}\right)^m\frac{2}{(m-1)!}
\sum_{k=0}^{n-2m}\cos\left((n-k)\frac{\pi}{2}\right)\\
&amp;\quad\times\frac{(n-1)!}{k!(n-k-2m)!!(n-k-1)!!}a^{n-k-2m}x^k.
\end{align*}\]</p><p>Dropping the terms that vanish because of the cosine, this can be recast as</p><p class="math-container">\[\begin{align*}
\left(L^m\circ f\right)(y, z)&amp;=\left(\frac{-\mathrm{Im}\,z}{2\pi}\right)^m
\frac{2}{(m-1)!}\frac{1}{(y-\mathrm{Re}\,z)^{2m}}
\sum_{n=0}^{\infty}\frac{1}{(y-\mathrm{Re}\,z)^n}
\sum_{k=0}^{n\doteqdot 2}C_{nk}^{(m)}(\mathrm{Im}\,z)^{2k}\\
C_{nk}^{(m)}&amp;=(-1)^k\frac{(2m+n-1)!}{(n-2k)!(2k)!!(2m+2k-1)!!}(M\circ f)(n-2k),
\end{align*}\]</p><p>where <span>$n\doteqdot 2$</span> means the integer division of <span>$n$</span> by <span>$2$</span>. The structure <a href="lorentz.html#PiecewiseLorentz.LorentzTransform"><code>LorentzTransform</code></a> stores the piecewise function and the expansion coefficients <span>$C_{nk}^{(m)}$</span>. If <span>$y-\mathrm{Re}\,z$</span> is outside the <a href="index.html#Piecewise.support">support</a> of the function <span>$f(x)$</span> and if the definition of the Lorentz transform yields a result smaller than <code>ground</code>, the moment expansion is used.</p><h2 id="Primitives"><a class="docs-heading-anchor" href="#Primitives">Primitives</a><a id="Primitives-1"></a><a class="docs-heading-anchor-permalink" href="#Primitives" title="Permalink"></a></h2><p>Here, we describe the primitives added by <a href="https://github.com/ChristopheBerthod/Piecewise.jl">PiecewiseLorentz</a> to the <a href="index.html#Formulas">Formulas</a> provided by <a href="index.html#Piecewise">Piecewise</a>. In order to handle even and odd piecewise functions, we define the primitive of <span>$F(x,\mathbf{a})\left[\frac{-\mathrm{Im}\,z/\pi}{(y-\mathrm{Re}\,z-sx)^2+(\mathrm{Im}\,z)^2}\right]^m$</span> as <span>$\mathcal{F}_m(s,x,\mathbf{a},y,z)$</span> with <span>$s=\pm1$</span>. </p><p><a href="lorentz.html#POLY-L"><code>POLY</code></a> |  <a href="lorentz.html#LOG-L"><code>LOG</code></a> |  <a href="lorentz.html#PLS-L"><code>PLS</code></a> <a href="lorentz.html#XLOG-L"><code>XLOG</code></a></p><hr/><h5 id="POLY-L"><a class="docs-heading-anchor" href="#POLY-L"><code>POLY</code></a><a id="POLY-L-1"></a><a class="docs-heading-anchor-permalink" href="#POLY-L" title="Permalink"></a></h5><p>The function <code>POLY.value(x, a)</code> is</p><p class="math-container">\[F(x,\mathbf{a}) = \sum_{i=1}^k a_i x^{i-1}.\]</p><p>The primitive function for the Lorentz kernel of order <span>$m$</span> is</p><p class="math-container">\[\begin{equation*}
\mathcal{F}_m(s,x,\mathbf{a},y,z) = \left[\frac{-\mathrm{Im}\,z/\pi}{(y-\mathrm{Re}\,z)^2+(\mathrm{Im}\,z)^2}
\right]^m\sum_{i=1}^k\frac{a_ix^i}{i}
F_1\left(i,m,m,i+1,\frac{sx}{y-z},\frac{sx}{y-z^*}\right),
\end{equation*}\]</p><p>where <span>$F_1$</span> is the <a href="https://en.wikipedia.org/wiki/Appell_series">Appell function</a>.</p><p>Since the Appell function isn&#39;t available yet in pure <code>Julia</code> <sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>, we use alternate forms for <span>$m=1$</span>, <span>$2$</span>, and <span>$3$</span>, that involve the hypergeometric function <span>${_2F_1}(a,b,c,z)$</span>:</p><p class="math-container">\[\begin{align*}
\mathcal{F}_1(s,x,\mathbf{a},y,z) &amp;=
\frac{-\mathrm{Im}\,z/\pi}{(y-\mathrm{Re}\,z)^2+(\mathrm{Im}\,z)^2}
\sum_{i=1}^k\frac{a_ix^i}{i}\mathrm{Re}\left\{\frac{y-z^*}{z-z^*}
\left[2\,{_2F_1}\left(1,i,i+1,\frac{sx}{y-z}\right)\right]\right\}\\
\mathcal{F}_2(s,x,\mathbf{a},y,z) &amp;=
\frac{1}{2\pi^2[(y-\mathrm{Re}\,z)^2+(\mathrm{Im}\,z)^2]}
\sum_{i=1}^k\frac{a_ix^i}{i}\mathrm{Re}\left\{\frac{y-z^*}{z-z^*}
\left[\phantom{\frac{1}{1}}\right.\right.\\
&amp;\quad\left.\left.\left(2+(i-1)\frac{z-z^*}{y-z}\right)
{_2F_1}\left(1,i,i+1,\frac{sx}{y-z}\right)
-i\frac{z-z^*}{y-z-sx}\right]\right\}\\
\mathcal{F}_3(s,x,\mathbf{a},y,z) &amp;=
-\frac{1}{16\pi^3\,\mathrm{Im}\,z[(y-\mathrm{Re}\,z)^2+(\mathrm{Im}\,z)^2]}
\sum_{i=1}^k\frac{a_ix^i}{i}\mathrm{Re}\left\{\frac{y-z^*}{y-z}
\left[\phantom{\frac{1}{1}}\right.\right.\\
&amp;\quad\left(12+6(i-1)\frac{z-z^*}{y-z}
+(i-1)(i-2)\left(\frac{z-z^*}{y-z}\right)^2\right)
{_2F_1}\left(1,i,i+1,\frac{sx}{y-z}\right)\\
&amp;\quad\left.\left.-6i\frac{z-z^*}{y-z-sx}+i\left(1-(i-2)
\frac{y-z-sx}{y-z}\right)\left(\frac{z-z^*}{y-z-sx}\right)^2\right]\right\}.
\end{align*}\]</p><p><span>${_2F_1}(a,b,c,z)$</span> is continuous for <span>$z\in\mathbb{C}$</span>, except on the real axis <span>$z=r\in\mathbb{R}$</span> for <span>$r&gt;1$</span>. Since <span>$sx/(y-z)$</span> crosses the real axis at <span>$x=0$</span>, the primitives are continuous for <span>$x\in\mathbb{R}$</span>.</p><hr/><h5 id="LOG-L"><a class="docs-heading-anchor" href="#LOG-L"><code>LOG</code></a><a id="LOG-L-1"></a><a class="docs-heading-anchor-permalink" href="#LOG-L" title="Permalink"></a></h5><p>The function <code>LOG.value(x, a)</code> is</p><p class="math-container">\[F(x,\mathbf{a}) = a_2\ln|x-a_1|.\]</p><p>The primitive function is unknown for the Lorentz kernel of general order. For the orders <span>$m=1$</span>, <span>$2$</span>, and <span>$3$</span>, they are</p><p class="math-container">\[\begin{align*}
\mathcal{F}_1(s,x,\mathbf{a},y,z) &amp;= \frac{sa_2}{\pi}\,\mathrm{Im}\left\{
\ln|x-a_1|\ln\left(\frac{y-z-sx}{y-z-sa_1}\right)
+\mathrm{Li}_2\left(\frac{s(x-a_1)}{y-z-sa_1}\right)\right\}\\
\mathcal{F}_2(s,x,\mathbf{a},y,z) &amp;= -\frac{sa_2}{2\pi^2\,\mathrm{Im}\,z}
\,\mathrm{Im}\left\{\ln|x-a_1|\ln\left(\frac{y-z-sx}{y-z-sa_1}\right)
+\mathrm{Li}_2\left(\frac{s(x-a_1)}{y-z-sa_1}\right)\right.\\
&amp;\quad\left.+i\,\mathrm{Im}\,z\left[\frac{\ln|x-a_1|}{y-z-sx}
+\frac{\ln(y-z-sx)-\ln|x-a_1|}{y-z-sa_1}\right]\right\}\\
\mathcal{F}_3(s,x,\mathbf{a},y,z) &amp;= \frac{3sa_2}{8\pi^3(\mathrm{Im}\,z)^2}
\,\mathrm{Im}\left\{\ln|x-a_1|\ln\left(\frac{y-z-sx}{y-z-sa_1}\right)
+\mathrm{Li}_2\left(\frac{s(x-a_1)}{y-z-sa_1}\right)\right.\\
&amp;\quad+i\,\mathrm{Im}\,z\left[\frac{\ln|x-a_1|}{y-z-sx}
+\frac{\ln(y-z-sx)-\ln|x-a_1|}{y-z-sa_1}\right]
+\frac{(\mathrm{Im}\,z)^2}{3}\left[\frac{\ln|x-a_1|}{(y-z-sx)^2}\right.\\
&amp;\quad\left.\left.+\frac{\ln(y-z-sx)-\ln|x-a_1|}{(y-z-sa_1)^2}
-\frac{1}{(y-z-sa_1)(y-z-sx)}\right]\right\},
\end{align*}\]</p><p>where <span>$\mathrm{Li}_2(z)$</span> is the <a href="https://en.wikipedia.org/wiki/Polylogarithm">polylogarithm</a>. Both functions <span>$\ln(z)$</span> and <span>$\mathrm{Li}_2(z)$</span> are continuous for <span>$z\in\mathbb{C}$</span>, except on the real axis, where the imaginary part has a branch cut. Since both <span>$(y-z-sx)/(y-z-sa_1)$</span> and <span>$s(x-a_1)/(y-z-a_1)$</span> cross the real axis at <span>$x=a_1$</span>, the primitives are continuous in the domains where they can be used.</p><hr/><h5 id="PLS-L"><a class="docs-heading-anchor" href="#PLS-L"><code>PLS</code></a><a id="PLS-L-1"></a><a class="docs-heading-anchor-permalink" href="#PLS-L" title="Permalink"></a></h5><p>The function <code>PLS.value(x, a)</code> is</p><p class="math-container">\[F(x,\mathbf{a}) = a_3|x-a_1|^{a_2}.\]</p><p>The primitive function for the Lorentz kernel of order <span>$m$</span> is</p><p class="math-container">\[\begin{align*}
\mathcal{F}_m(s,x,\mathbf{a},y,z) &amp;= \left[\frac{-\mathrm{Im}\,z/\pi}{(y-\mathrm{Re}\,z-sa_1)^2+(\mathrm{Im}\,z)^2}
\right]^ma_3|x-a_1|^{a_2}\frac{x-a_1}{a_2+1}\\
&amp;\quad\times F_1\left(a_2+1,m,m,a_2+2,\frac{s(x-a_1)}{y-z-sa_1},
\frac{s(x-a_1)}{y-z^*-sa_1}\right),
\end{align*}\]</p><p>where <span>$F_1$</span> is the <a href="https://en.wikipedia.org/wiki/Appell_series">Appell function</a>.</p><p>Since the Appell function isn&#39;t available yet in pure <code>Julia</code> <sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>, we use alternate forms for <span>$m=1$</span>, <span>$2$</span>, and <span>$3$</span>, that involve the hypergeometric function <span>${_2F_1}(a,b,c,z)$</span>:</p><p class="math-container">\[\begin{align*}
\mathcal{F}_1(s,x,\mathbf{a},y,z) &amp;= 
\frac{-\mathrm{Im}\,z/\pi}{(y-\mathrm{Re}\,z-sa_1)^2+(\mathrm{Im}\,z)^2}
a_3|x-a_1|^{a_2}\frac{x-a_1}{a_2+1}
\,\mathrm{Re}\left\{\phantom{\frac{1}{1}}\right.\\
&amp;\quad\left.\frac{y-z^*-sa_1}{z-z^*}\left[
2\,{_2F_1}\left(1,a_2+1,a_2+2,\frac{s(x-a_1)}{y-z-sa_1}\right)\right]\right\}\\
\mathcal{F}_2(s,x,\mathbf{a},y,z) &amp;=
\frac{1}{2\pi^2[(y-\mathrm{Re}\,z-sa_1)^2+(\mathrm{Im}\,z)^2]}
a_3|x-a_1|^{a_2}\frac{x-a_1}{a_2+1}
\,\mathrm{Re}\left\{\phantom{\frac{1}{1}}\right.\\
&amp;\quad\frac{y-z^*-sa_1}{z-z^*}\left[\left(2+a_2\frac{z-z^*}{y-z-sa_1}\right)
{_2F_1}\left(1,a_2+1,a_2+2,\frac{s(x-a_1)}{y-z-sa_1}\right)\right.\\
&amp;\quad\left.\left.-(a_2+1)\frac{z-z^*}{y-z-sx}\right]\right\}\\
\mathcal{F}_3(s,x,\mathbf{a},y,z) &amp;=
-\frac{1}{16\pi^3\,\mathrm{Im}\,z[(y-\mathrm{Re}\,z-sa_1)^2+(\mathrm{Im}\,z)^2]}
a_3|x-a_1|^{a_2}\frac{x-a_1}{a_2+1}
\,\mathrm{Re}\left\{\phantom{\frac{1}{1}}\right.\\
&amp;\quad\frac{y-z^*-sa_1}{z-z^*}\left[\left(12+6a_2\frac{z-z^*}{y-z-sa_1}
+a_2(a_2-1)\left(\frac{z-z^*}{y-z-sa_1}\right)^2\right)\right.\\
&amp;\quad\times{_2F_1}\left(1,a_2+1,a_2+2,\frac{s(x-a_1)}{y-z-sa_1}\right)
-6(a_2+1)\frac{z-z^*}{y-z-sx}\\
&amp;\quad\left.\left.+(a_2+1)\left(1-(a_2-1)
\frac{y-z-sx}{y-z-sa_1}\right)
\left(\frac{z-z^*}{y-z-sx}\right)^2\right]\right\}.
\end{align*}\]</p><p><span>${_2F_1}(a,b,c,z)$</span> is continuous for <span>$z\in\mathbb{C}$</span>, except on the real axis, where the imaginary part has a branch cut. Since <span>$s(x-a_1)/(y-z-sa_1)$</span> crosses the real axis at <span>$x=a_1$</span>, the primitives are continuous in the domain, which must exclude <span>$a_1$</span>.</p><hr/><h5 id="XLOG-L"><a class="docs-heading-anchor" href="#XLOG-L"><code>XLOG</code></a><a id="XLOG-L-1"></a><a class="docs-heading-anchor-permalink" href="#XLOG-L" title="Permalink"></a></h5><p>The function <code>XLOG.value(x, a)</code> is</p><p class="math-container">\[F(x,\mathbf{a}) = a_2x\ln|x-a_1|.\]</p><p>The primitive function is unknown for the Lorentz kernel of general order. For the orders <span>$m=1$</span>, <span>$2$</span>, and <span>$3$</span>, they are</p><p class="math-container">\[\begin{align*}
\mathcal{F}_1(s,x,\mathbf{a},y,z) &amp;= \frac{a_2}{\pi}\,\mathrm{Im}\left\{
(y-z)\left[\ln|x-a_1|\ln\left(\frac{y-z-sx}{y-z-sa_1}\right)
+\mathrm{Li}_2\left(\frac{s(x-a_1)}{y-z-sa_1}\right)\right]\right\}\\
\mathcal{F}_2(s,x,\mathbf{a},y,z) &amp;= -\frac{a_2}{2\pi^2\,\mathrm{Im}\,z}
\,\mathrm{Im}\left\{(y-\mathrm{Re}\,z)\left[
\ln|x-a_1|\ln\left(\frac{y-z-sx}{y-z-sa_1}\right)
+\mathrm{Li}_2\left(\frac{s(x-a_1)}{y-z-sa_1}\right)\right]\right.\\
&amp;\quad\left.+i\,(y-z)\mathrm{Im}\,z\left[\frac{\ln|x-a_1|}{y-z-sx}
+\frac{\ln(y-z-sx)-\ln|x-a_1|}{y-z-sa_1}\right]\right\}\\
\mathcal{F}_3(s,x,\mathbf{a},y,z) &amp;= \frac{3a_2}{8\pi^3(\mathrm{Im}\,z)^2}
\,\mathrm{Im}\left\{(y-\mathrm{Re}\,z)\left[
\ln|x-a_1|\ln\left(\frac{y-z-sx}{y-z-sa_1}\right)
+\mathrm{Li}_2\left(\frac{s(x-a_1)}{y-z-sa_1}\right)\right]\right.\\
&amp;\quad+i\,\left(y-z+\frac{2i}{3}\mathrm{Im}\,z\right)
\mathrm{Im}\,z\left[\frac{\ln|x-a_1|}{y-z-sx}
+\frac{\ln(y-z-sx)-\ln|x-a_1|}{y-z-sa_1}\right]\\
&amp;\quad+\frac{(\mathrm{Im}\,z)^2}{3}(y-z)\left[\frac{\ln|x-a_1|}{(y-z-sx)^2}
+\frac{\ln(y-z-sx)-\ln|x-a_1|}{(y-z-sa_1)^2}\right.\\
&amp;\quad\left.\left.-\frac{1}{(y-z-sa_1)(y-z-sx)}\right]\right\},
\end{align*}\]</p><p>where <span>$\mathrm{Li}_2(z)$</span> is the <a href="https://en.wikipedia.org/wiki/Polylogarithm">polylogarithm</a>. Both functions <span>$\ln(z)$</span> and <span>$\mathrm{Li}_2(z)$</span> are continuous for <span>$z\in\mathbb{C}$</span>, except on the real axis, where the imaginary part has a branch cut. Since both <span>$(y-z-sx)/(y-z-sa_1)$</span> and <span>$s(x-a_1)/(y-z-a_1)$</span> cross the real axis at <span>$x=a_1$</span>, the primitives are continuous in the domains where they can be used.</p><h2 id="Public-interface"><a class="docs-heading-anchor" href="#Public-interface">Public interface</a><a id="Public-interface-1"></a><a class="docs-heading-anchor-permalink" href="#Public-interface" title="Permalink"></a></h2><h3 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h3><ul><li><a href="lorentz.html#PiecewiseLorentz.LorentzTransform"><code>PiecewiseLorentz.LorentzTransform</code></a></li><li><a href="lorentz.html#PiecewiseLorentz.lorentz_transform"><code>PiecewiseLorentz.lorentz_transform</code></a></li></ul><h3 id="Type"><a class="docs-heading-anchor" href="#Type">Type</a><a id="Type-1"></a><a class="docs-heading-anchor-permalink" href="#Type" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PiecewiseLorentz.LorentzTransform" href="#PiecewiseLorentz.LorentzTransform"><code>PiecewiseLorentz.LorentzTransform</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LorentzTransform(f::PiecewiseFunction, m::Integer[, ground::Real=1e-10])</code></pre><p>Return a <code>LorentzTransform</code> object for the piecewise function <code>f</code>.</p><p><code>m</code> is the order of the transform. The <code>LorentzTransform</code> object behaves as a function with arguments <code>(y::Real, z::Complex)</code>. A moment expansion is used if <span>$y-\mathrm{Re}\,z$</span> is outside the <a href="index.html#Piecewise.support">support</a> of the piecewise function and if the result of the transform is smaller than <code>ground</code>.</p><p><strong>Fields</strong></p><ul><li><code>f::PiecewiseFunction</code></li><li><code>m::Integer</code></li><li><code>ground::Real</code></li><li><code>moments::Vector{Real}</code></li></ul><p><strong>Example</strong></p><p><span>$L^2$</span> transform of a box:</p><pre><code class="language-jldocs hljs">julia&gt; L = LorentzTransform(PiecewiseFunction(Piece((-1, 1), POLY, [1])), 2)
&lt; L^2 transform of piecewise function with support [-1.0, 1.0] &gt;

julia&gt; L(0, -im)
0.13023806336711655</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ChristopheBerthod/Piecewise.jl/blob/cb23c1e3f988d6169e82daae0bdcc51675f9bc52/PiecewiseLorentz/src/types.jl#L3-L30">source</a></section></article><h3 id="Methods"><a class="docs-heading-anchor" href="#Methods">Methods</a><a id="Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Methods" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PiecewiseLorentz.lorentz_transform" href="#PiecewiseLorentz.lorentz_transform"><code>PiecewiseLorentz.lorentz_transform</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">lorentz_transform(f::PiecewiseFunction, m::Integer, y::Real, z::Complex)</code></pre><p>Return the Lorentz transform of the piecewise function <code>f</code>:</p><p class="math-container">\[(L^m\circ f)(y, z) = \int_{-\infty}^{\infty}dx\,f(x)\left[\frac{\mathrm{Im}
\,z/\pi}{(y-\mathrm{Re}\,z-x)^2+(\mathrm{Im}\,z)^2}\right]^m.\]</p><p><strong>Example</strong></p><pre><code class="language-jldocs hljs">julia&gt; lorentz_transform(PiecewiseFunction([Piece((-1, 1), POLY, [1])]), 2, 0, -im)
0.13023806336711655</code></pre><p>See also <a href="lorentz.html#PiecewiseLorentz.LorentzTransform"><code>LorentzTransform</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ChristopheBerthod/Piecewise.jl/blob/cb23c1e3f988d6169e82daae0bdcc51675f9bc52/PiecewiseLorentz/src/public-methods.jl#L28-L44">source</a></section></article><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>It would be available through <code>sympy.functions.special.hyper.appellf1</code>.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="hilbert.html">« PiecewiseHilbert</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Thursday 24 July 2025 04:33">Thursday 24 July 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
