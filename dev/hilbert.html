<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>PiecewiseHilbert · Piecewise</title><meta name="title" content="PiecewiseHilbert · Piecewise"/><meta property="og:title" content="PiecewiseHilbert · Piecewise"/><meta property="twitter:title" content="PiecewiseHilbert · Piecewise"/><meta name="description" content="Documentation for Piecewise."/><meta property="og:description" content="Documentation for Piecewise."/><meta property="twitter:description" content="Documentation for Piecewise."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="index.html"><img src="assets/logo.png" alt="Piecewise logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">Piecewise</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Piecewise</a></li><li class="is-active"><a class="tocitem" href="hilbert.html">PiecewiseHilbert</a><ul class="internal"><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#momentexpansion-H"><span>Moment expansion</span></a></li><li><a class="tocitem" href="#Primitives"><span>Primitives</span></a></li><li><a class="tocitem" href="#Example"><span>Example</span></a></li><li><a class="tocitem" href="#Public-interface"><span>Public interface</span></a></li></ul></li><li><a class="tocitem" href="lorentz.html">PiecewiseLorentz</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="hilbert.html">PiecewiseHilbert</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="hilbert.html">PiecewiseHilbert</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ChristopheBerthod/Piecewise.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ChristopheBerthod/Piecewise.jl/blob/main/docs/src/hilbert.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="PiecewiseHilbert"><a class="docs-heading-anchor" href="#PiecewiseHilbert">PiecewiseHilbert</a><a id="PiecewiseHilbert-1"></a><a class="docs-heading-anchor-permalink" href="#PiecewiseHilbert" title="Permalink"></a></h1><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><p>The package won&#39;t work without <a href="https://github.com/ChristopheBerthod/Piecewise.jl">Piecewise</a>. Both can be installed with <code>Pkg.add</code>.</p><pre><code class="language-julia hljs">using Pkg; Pkg.add(&quot;Piecewise&quot;); Pkg.add(&quot;PiecewiseHilbert&quot;)</code></pre><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>The Hilbert transform of a function <span>$f(x)$</span> of a real variable <span>$x$</span> is defined as</p><p class="math-container">\[(H\circ f)(z) = \int_{-\infty}^{\infty}dx\,\frac{f(x)}{z-x},\]</p><p>where <span>$z\in\mathbb{C}\setminus\mathbb{R}$</span> is a complex number with non-zero imaginary part. The transform is well-defined if <span>$f(x)$</span> has no non-integrable singularity and if it vanishes at infinity faster than <span>$|x|^{-\epsilon}$</span> with <span>$\epsilon&gt;0$</span> <sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>. In the limiting case <span>$\epsilon=0$</span>, the transform is well-defined only if <span>$f(+\infty)=f(-\infty)$</span>.</p><p>The module <a href="https://github.com/ChristopheBerthod/Piecewise.jl">PiecewiseHilbert</a> adds to the <a href="index.html#Formulas">Formulas</a> defined in the module <a href="index.html#Piecewise">Piecewise</a> the primitive functions corresponding to the Hilbert kernel <span>$1/(z-x)$</span>, enabling the fast Hilbert transform of piecewise functions using these formulas.</p><p>The method <a href="hilbert.html#PiecewiseHilbert.hilbert_transform"><code>hilbert_transform</code></a> returns the Hilbert transform of a <a href="index.html#PiecewiseFunction"><code>PiecewiseFunction</code></a> object, as calculated using the definition above. It also works with user-defined <a href="index.html#Piecewise.Formula"><code>Formula</code></a> objects. Depending on the formulas used, however, the result can be numerically unstable at large <span>$|z|$</span>. This is circumvented by means of a <a href="hilbert.html#momentexpansion-H">moment expansion</a>. Both the definition and the moment expansion are implemented in a <a href="hilbert.html#PiecewiseHilbert.HilbertTransform"><code>HilbertTransform</code></a> object created as:</p><pre><code class="nohighlight hljs">H = HilbertTransform(f::PiecewiseFunction[, radius::Real])</code></pre><p>The moment expansion is used if <span>$|z|&gt;$</span> <code>radius</code> (set automatically by default). Once initialized, the Hilbert transform can be evaluated as <code>H(z)</code>.</p><h2 id="momentexpansion-H"><a class="docs-heading-anchor" href="#momentexpansion-H">Moment expansion</a><a id="momentexpansion-H-1"></a><a class="docs-heading-anchor-permalink" href="#momentexpansion-H" title="Permalink"></a></h2><p>The large-<span>$|z|$</span> expansion of the Hilbert transform is</p><p class="math-container">\[(H\circ f)(z) = \sum_{n=0}^{\infty}\frac{(M\circ f)(n)}{z^{n+1}},\qquad
(M\circ f)(n) = \int_{-\infty}^{\infty}dx\,f(x)x^n.\]</p><p>The structure <a href="hilbert.html#PiecewiseHilbert.HilbertTransform"><code>HilbertTransform</code></a> stores the piecewise function and its moments, as provided by the method <a href="index.html#moment"><code>moment</code></a> of <a href="index.html#Piecewise">Piecewise</a>, such that a numerically stable result is produced using the definition of the Hilbert transform within a given disk in the complex plane and the moment expansion beyond that disk.</p><h2 id="Primitives"><a class="docs-heading-anchor" href="#Primitives">Primitives</a><a id="Primitives-1"></a><a class="docs-heading-anchor-permalink" href="#Primitives" title="Permalink"></a></h2><p>Here, we describe the primitives added by <a href="https://github.com/ChristopheBerthod/Piecewise.jl">PiecewiseHilbert</a> to the <a href="index.html#Formulas">Formulas</a> provided by <a href="index.html#Piecewise">Piecewise</a>.</p><p><a href="hilbert.html#POLY-H"><code>POLY</code></a> |  <a href="hilbert.html#TAIL-H"><code>TAIL</code></a> |  <a href="hilbert.html#LOG-H"><code>LOG</code></a> | <a href="hilbert.html#ISRS-H"><code>ISRS</code></a> | <a href="hilbert.html#PLS-H"><code>PLS</code></a> | <a href="hilbert.html#XLOG-H"><code>XLOG</code></a> | <a href="hilbert.html#XISRS-H"><code>XISRS</code></a></p><hr/><h5 id="POLY-H"><a class="docs-heading-anchor" href="#POLY-H"><code>POLY</code></a><a id="POLY-H-1"></a><a class="docs-heading-anchor-permalink" href="#POLY-H" title="Permalink"></a></h5><p>The function <code>POLY.value(x, a)</code> is</p><p class="math-container">\[F(x,\mathbf{a}) = \sum_{i=1}^k a_i x^{i-1}.\]</p><p>A primitive function for the Hilbert kernel is</p><p class="math-container">\[\mathcal{F}(x,\mathbf{a},z) = -\ln(x-z)\sum_{i=1}^k a_i z^{i-1}
-\sum_{i=0}^{k-2}z^i\sum_{j=i}^{k-2}a_{j+2}\frac{x^{j-i+1}}{j-i+1}.\]</p><p>This primitive is interesting, because it involves only elementary functions. Unfortunately, it suffers from numerical instability at large <span>$z$</span>. We use another primitive that is stable at large <span>$z$</span>, although slightly slower as it requires the <a href="https://en.wikipedia.org/wiki/Hypergeometric_function">hypergeometric function</a> <span>${_2F_1}(a,b,c,z)$</span>:</p><p class="math-container">\[\mathcal{F}(x,\mathbf{a},z) = \frac{1}{z}\sum_{i=1}^k\frac{a_ix^i}{i}
{_2F_1}\left(1,i,i+1,\frac{x}{z}\right).\]</p><p>This primitive is continuous for <span>$x\in\mathbb{R}$</span>.</p><hr/><h5 id="TAIL-H"><a class="docs-heading-anchor" href="#TAIL-H"><code>TAIL</code></a><a id="TAIL-H-1"></a><a class="docs-heading-anchor-permalink" href="#TAIL-H" title="Permalink"></a></h5><p>The function <code>TAIL.value(x, a)</code> is</p><p class="math-container">\[F(x,\mathbf{a}) = \frac{a_1+a_2x}{a_3+a_4x+a_5x^2}.\]</p><p>The primitive function for the Hilbert kernel is</p><p class="math-container">\[\begin{align*}
\mathcal{F}(x,\mathbf{a},z) &amp;= -\frac{1}{a_3+a_4z+a_5z^2}\left\{
(a_1+a_2z)\left[\ln(z-x)-\ln\sqrt{a_3+a_4x+a_5x^2}\right]
\phantom{\frac{\frac{1_1^1}{1_1^1}}{1_1^1}}\right.
\\&amp;\quad\left. -\left[2a_2a_3-a_1a_4+(a_2a_4-2a_1a_5)z\right]
\frac{\tanh^{-1}\left(\frac{a_4+2a_5x}{\Delta}\right)}{\Delta}\right\},
\end{align*}\]</p><p>where <span>$\Delta=\sqrt{a_4^2-4a_3a_5}$</span>. This primitive is obviously continuous for <span>$x\in\mathbb{R}$</span> if <span>$a_4^2-4a_3a_5&lt;0$</span>, because in that case the zeros <span>$x_{\pm}$</span> of <span>$a_3+a_4x+a_5x^2$</span> are not on the real axis, such that <span>$a_3+a_4x+a_5x^2$</span> does not change sign and, therefore, has the sign of <span>$a_3$</span>. If <span>$a_4^2-4a_3a_5&gt;0$</span>, both <span>$\ln\sqrt{\cdots}$</span> and <span>$\tanh^{-1}(\cdots)$</span> have a discontinuous imaginary part at <span>$x=x_{\pm}$</span>. However, since none of these zeros lies inside the domain, the function is continuous in the domain.</p><hr/><h5 id="LOG-H"><a class="docs-heading-anchor" href="#LOG-H"><code>LOG</code></a><a id="LOG-H-1"></a><a class="docs-heading-anchor-permalink" href="#LOG-H" title="Permalink"></a></h5><p>The function <code>LOG.value(x, a)</code> is</p><p class="math-container">\[F(x,\mathbf{a}) = a_2\ln|x-a_1|.\]</p><p>The primitive function for the Hilbert kernel is</p><p class="math-container">\[\mathcal{F}(x,\mathbf{a},z) = -a_2\left[\ln|x-a_1|
\ln\left(\frac{z-x}{z-a_1}\right)
+\mathrm{Li}_2\left(\frac{x-a_1}{z-a_1}\right)\right],\]</p><p>where <span>$\mathrm{Li}_2(z)$</span> is the <a href="https://en.wikipedia.org/wiki/Polylogarithm">polylogarithm</a>. Both functions <span>$\ln(z)$</span> and <span>$\mathrm{Li}_2(z)$</span> are continuous for <span>$z\in\mathbb{C}$</span>, except on the real axis, where the imaginary part has a branch cut. Since both <span>$(z-x)/(z-a_1)$</span> and <span>$(x-a_1)/(z-a_1)$</span> cross the real axis at <span>$x=a_1$</span>, the primitive is continuous in the domains where it can be used.</p><hr/><h5 id="ISRS-H"><a class="docs-heading-anchor" href="#ISRS-H"><code>ISRS</code></a><a id="ISRS-H-1"></a><a class="docs-heading-anchor-permalink" href="#ISRS-H" title="Permalink"></a></h5><p>The function <code>ISRS.value(x, a)</code> is</p><p class="math-container">\[F(x,\mathbf{a}) = \frac{a_2}{\sqrt{|x^2-a_1^2|}}.\]</p><p>The primitive function for the Hilbert kernel is</p><p class="math-container">\[\mathcal{F}(x,\mathbf{a},z) = -\frac{a_2}{\sqrt{|x^2-a_1^2|}}
\frac{\sqrt{x^2-a_1^2}}{\sqrt{z^2-a_1^2}}\tanh^{-1}
\left(\frac{a_1^2-xz}{\sqrt{x^2-a_1^2}\sqrt{z^2-a_1^2}}\right).\]</p><p>This primitive is discontinuous at <span>$x=\pm a_1$</span> but continuous everywhere else, so it is continuous inside the domains where it can be used.</p><hr/><h5 id="PLS-H"><a class="docs-heading-anchor" href="#PLS-H"><code>PLS</code></a><a id="PLS-H-1"></a><a class="docs-heading-anchor-permalink" href="#PLS-H" title="Permalink"></a></h5><p>The function <code>PLS.value(x, a)</code> is</p><p class="math-container">\[F(x,\mathbf{a}) = a_3|x-a_1|^{a_2}.\]</p><p>The primitive function for the Hilbert kernel is</p><p class="math-container">\[\mathcal{F}(x,\mathbf{a},z) = \frac{a_3|x-a_1|^{a_2}}{1+a_2}
\frac{x-a_1}{z-a_1}{_2F_1}\left(1,a_2+1,a_2+2,\frac{x-a_1}{z-a_1}\right),\]</p><p>where <span>${_2F_1}(a,b,c,z)$</span> is the <a href="https://en.wikipedia.org/wiki/Hypergeometric_function">hypergeometric function</a>. <span>${_2F_1}(a,b,c,z)$</span> is continuous for <span>$z\in\mathbb{C}$</span>, except on the real axis, where the imaginary part has a branch cut. Since <span>$(x-a_1)/(z-a_1)$</span> crosses the real axis at <span>$x=a_1$</span>, the primitive is continuous in the domain, which must exclude <span>$a_1$</span>.</p><hr/><h5 id="XLOG-H"><a class="docs-heading-anchor" href="#XLOG-H"><code>XLOG</code></a><a id="XLOG-H-1"></a><a class="docs-heading-anchor-permalink" href="#XLOG-H" title="Permalink"></a></h5><p>The function <code>XLOG.value(x, a)</code> is</p><p class="math-container">\[F(x,\mathbf{a}) = a_2x\ln|x-a_1|.\]</p><p>The primitive function for the Hilbert kernel is</p><p class="math-container">\[\mathcal{F}(x,\mathbf{a},z) = a_2\left\{x-\ln|x-a_1|\left[x-a_1
+z\ln\left(\frac{z-x}{z-a_1}\right)\right]
-z\,\mathrm{Li}_2\left(\frac{x-a_1}{z-a_1}\right)\right\},\]</p><p>where <span>$\mathrm{Li}_2(z)$</span> is the <a href="https://en.wikipedia.org/wiki/Polylogarithm">polylogarithm</a>. Both functions <span>$\ln(z)$</span> and <span>$\mathrm{Li}_2(z)$</span> are continuous for <span>$z\in\mathbb{C}$</span>, except on the real axis, where the imaginary part has a branch cut. Since both <span>$(z-x)/(z-a_1)$</span> and <span>$(x-a_1)/(z-a_1)$</span> cross the real axis at <span>$x=a_1$</span>, the primitive is continuous in the domains where it can be used.</p><hr/><h5 id="XISRS-H"><a class="docs-heading-anchor" href="#XISRS-H"><code>XISRS</code></a><a id="XISRS-H-1"></a><a class="docs-heading-anchor-permalink" href="#XISRS-H" title="Permalink"></a></h5><p>The function <code>XISRS.value(x, a)</code> is</p><p class="math-container">\[F(x,\mathbf{a}) = \frac{a_2x}{\sqrt{|x^2-a_1^2|}}.\]</p><p>The primitive function for the Hilbert kernel is</p><p class="math-container">\[\mathcal{F}(x,\mathbf{a},z) = -\frac{a_2\sqrt{x^2-a_1^2}}{\sqrt{|x^2-a_1^2|}}
\left[\tanh^{-1}\left(\frac{x}{\sqrt{x^2-a_1^2}}\right)
+\frac{z}{\sqrt{z^2-a_1^2}}\tanh^{-1}\left(\frac{a_1^2-xz}
{\sqrt{x^2-a_1^2}\sqrt{z^2-a_1^2}}\right)\right].\]</p><p>This primitive is discontinuous at <span>$x=\pm a_1$</span> but continuous everywhere else, so it is continuous inside the domains where it can be used.</p><h2 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h2><p>The following example produces an image similar to the <a href="index.html#Piecewise">Piecewise</a> logo.</p><pre><code class="language-julia hljs">f = PiecewiseFunction([
    Piece((-1, -6/10), (true, false), LOG, [-6/10, -1]),
    Piece((-6/10, -3/10), (false, true), [POLY, LOG], [[2, 10/3], [-6/10, -1]]),
    Piece((-3/10, 0), (false, true), [POLY, LOG, XLOG],
        [[1+log(10/3)], [-3/10, 1+1/log(10/3)], [-3/10, 10/3*(1+1/log(10/3))]]),
    Piece((2/10, 5/10), (false, false), [XISRS, LOG], [[2/10, 1], [5/10, -1]]),
    Piece((5/10, 1), (false, false), [POLY, LOG, PLS],
        [[log(1/2)], [5/10, -1], [1, 1/4, 1]])
])

H = HilbertTransform(f)

using Plots
z1 = -2:0.001:1.5
plot(xlim=(-1.1, 1.1), ylim=(0, 6), axis=false, grid=false, legend=:none)
for z2 in reverse(0.01:0.015:0.6)
    plot!(z1 .+ z2*4/3, -imag.(H.(z1 .+ im*z2^2))/π .+ z2*20/3,
        color=:grey, fill=(0, :white))
end
plot!(z1, f.(z1), linewidth = 5, color = :red, fill=(0, :pink))</code></pre><p><img src="logo.svg" alt/></p><h2 id="Public-interface"><a class="docs-heading-anchor" href="#Public-interface">Public interface</a><a id="Public-interface-1"></a><a class="docs-heading-anchor-permalink" href="#Public-interface" title="Permalink"></a></h2><h3 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h3><ul><li><a href="hilbert.html#PiecewiseHilbert.HilbertTransform"><code>PiecewiseHilbert.HilbertTransform</code></a></li><li><a href="hilbert.html#PiecewiseHilbert.hilbert_transform"><code>PiecewiseHilbert.hilbert_transform</code></a></li></ul><h3 id="Type"><a class="docs-heading-anchor" href="#Type">Type</a><a id="Type-1"></a><a class="docs-heading-anchor-permalink" href="#Type" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PiecewiseHilbert.HilbertTransform" href="#PiecewiseHilbert.HilbertTransform"><code>PiecewiseHilbert.HilbertTransform</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HilbertTransform(f::PiecewiseFunction[, radius::Real])</code></pre><p>Return a <code>HilbertTransform</code> object for the piecewise function <code>f</code>.</p><p>The <code>HilbertTransform</code> object behaves as a function with argument <code>(z::Complex)</code>. A moment expansion is used beyond <span>$|z|$</span> = radius in the complex plane. If not specified, the radius is set automatically. The field <code>error</code> gives an estimate of the absolute error at <span>$|z|$</span> = radius.</p><p><strong>Fields</strong></p><ul><li><code>f::PiecewiseFunction</code></li><li><code>radius::Real</code></li><li><code>moments::Vector{Real}</code></li><li><code>error::Real</code></li></ul><p><strong>Example</strong></p><p>Hilbert transform of a box:</p><pre><code class="language-jldocs hljs">julia&gt; H = HilbertTransform(PiecewiseFunction(Piece((-1, 1), POLY, [1])))
&lt; Hilbert transform of piecewise function with support [-1.0, 1.0] &gt;

julia&gt; H.([1im, 10im, 100im])
3-element Vector{ComplexF64}:
 0.0 - 1.5707963267948966im
 0.0 - 0.19933730476190478im
 0.0 - 0.019999333333333334im</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ChristopheBerthod/Piecewise.jl/blob/cb23c1e3f988d6169e82daae0bdcc51675f9bc52/PiecewiseHilbert/src/types.jl#L3-L33">source</a></section></article><h3 id="Methods"><a class="docs-heading-anchor" href="#Methods">Methods</a><a id="Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Methods" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PiecewiseHilbert.hilbert_transform" href="#PiecewiseHilbert.hilbert_transform"><code>PiecewiseHilbert.hilbert_transform</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hilbert_transform(f::PiecewiseFunction, z::Complex)</code></pre><p>Return the Hilbert transform of the piecewise function <code>f</code> at the complex number <code>z</code>:</p><p class="math-container">\[(H\circ f)(z) = \int_{-\infty}^{\infty}dx\,\frac{f(x)}{z-x}\]</p><p><strong>Example</strong></p><pre><code class="language-jldocs hljs">julia&gt; hilbert_transform(PiecewiseFunction([Piece((-1, 1), POLY, [1])]), im)
0.0 - 1.5707963267948966im</code></pre><p>See also <a href="hilbert.html#PiecewiseHilbert.HilbertTransform"><code>HilbertTransform</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ChristopheBerthod/Piecewise.jl/blob/cb23c1e3f988d6169e82daae0bdcc51675f9bc52/PiecewiseHilbert/src/public-methods.jl#L28-L43">source</a></section></article><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>We have <span>$\int^x |x|^{-\epsilon}/(z-x)=(\mathrm{sign}(x)/z)^{\epsilon}B_{x/z}(1-\epsilon,0)$</span>, where <span>$B_z(a, b)$</span> is the <a href="https://en.wikipedia.org/wiki/Beta_function">incomplete beta function</a>, which approaches <span>$-\pi (\mp1/z)^{\epsilon}/\sin(\pi\epsilon)$</span> for <span>$x\to\pm\infty$</span>.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="index.html">« Piecewise</a><a class="docs-footer-nextpage" href="lorentz.html">PiecewiseLorentz »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Thursday 24 July 2025 04:33">Thursday 24 July 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
